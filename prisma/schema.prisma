generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  CUSTOMER
  ADMIN
}

enum OrderStatus {
  PENDING
  PAID
  CANCELLED
}

model User {
  id           Int      @id @default(autoincrement())
  name         String
  email        String   @unique
  passwordHash String
  role         Role     @default(CUSTOMER)
  createdAt    DateTime @default(now())
  orders       Order[]
}

model Product {
  id           Int              @id @default(autoincrement())
  name         String
  description  String
  basePrice    Float
  imageUrl     String
  category     String
  customizable Boolean          @default(true)
  isActive     Boolean          @default(true)
  options      ProductOption[]
  createdAt    DateTime         @default(now())
}

model ProductOption {
  id         Int     @id @default(autoincrement())
  type       String  // "BASE" | "PROTEIN" | "EXTRA"
  label      String
  priceDelta Float
  product    Product @relation(fields: [productId], references: [id])
  productId  Int
}

model Order {
  id              Int         @id @default(autoincrement())
  user            User        @relation(fields: [userId], references: [id])
  userId          Int
  status          OrderStatus @default(PAID)
  totalAmount     Float
  customerName    String
  customerPhone   String
  customerAddress String
  createdAt       DateTime    @default(now())
  items           OrderItem[]
}

model OrderItem {
  id               Int    @id @default(autoincrement())
  order            Order  @relation(fields: [orderId], references: [id])
  orderId          Int
  productId        Int
  quantity         Int
  unitPrice        Float
  customizationJson String?
}
